---
title: "Ecosystem modelling approaches:"
subtitle: "What questions can we address?"
author: "Sarah Gaichas, Sean Lucey, and Gavin Fay <br /> Northeast Fisheries Science Center and University of Massachusetts Dartmouth"
output:
  xaringan::moon_reader:
    css: ["default", "libs/EDAB_theme2.css"]
    lib_dir: libs
    nature:
      titleSlideClass: ["right", "middle", "my-title"]
      highlightStyle: githubp
      highlightLines: true
      countIncrementalSlides: false
  revealjs::revealjs_presentation:
    self_contained: false
    reveal_plugins: ["notes", "search"]
---
class: top, left

```{r setup, include=FALSE}

options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(echo = F,
                      warning = F,
                      message = F)
#Plotting and data libraries
library(ggplot2)
library(dplyr)
library(tidyr)
library(here)
library(kableExtra)
library(ggrepel)
library(stringr)

library(atlantisom)

data.dir <- here::here("data")

```

# What is an ecosystem model?

![ecomods](EDAB_images/ecomods.png)

---

## Why build one?

![whybuild](EDAB_images/piggiehippowhy.png)



???
---
# Suggestion:
.pull-left[
![whyindeed](EDAB_images/whyindeed.png)
]
.pull-right[
1. Clearly specified questions/objectives
2. Data availability
3. THEN build a model, or better, model(s)
]
---
# Today's objective

Primary: Think about *your* research question  
What data do you have to address it?  
Would a model be useful to address your research question?  
If so, what would you want it to do?   
Advanced: How might you build it?  

Secondary: Understand what a food web model is  
Know what questions to ask about how it was built  
Play with a food web model  
Perturb it in different ways  
What do you observe?  
Why might this be? (including model limitations)  

---
## What is a food web model?

.pull-left[
A system of linear equations

For each group, $i$, specify: 

   Biomass $B$ [or Ecotrophic Efficiency $EE$ ]  
   Population growth rate $\frac{P}{B}$  
   Consumption rate $\frac{Q}{B}$  
   Diet composition $DC$  
   Fishery catch $C$  
   Biomass accumulation $BA$  
   Im/emigration $IM$ and $EM$  
   
Solving for $EE$ [or $B$ ] for each group:
]

.pull-right[
![toyfoodweb](EDAB_images/toyfw.png)
]

$$B_i\Big(\frac{P}{B}\Big)_i*EE_i+IM_i+BA_i=\sum_{j}\Big[ B_j\Big (\frac{Q}{B}\Big)_j*DC_{ij}\Big ]+EM_i+C_i$$
???
Mathematically identical to an "input-output" model in economics

---
## How do you build one?

LIT

OBSERVATIONS


---

## What can you do with one? Lab overview
.pull-left[
Anchovy Bay food web model

1. Orientation using simple food web invented for illustration

1. Tradeoffs between fishering fleets targeting different species


]

.pull-right[
Gulf of Maine food web model

1. More complex food web model based on a real system

1. System reaction to different scenarios
    1. Changing fishing effort (combined fleet)
    1. Changing mortality for individual species
    1. Changing predator-prey dynamics

]
???
---
## The Gulf of Maine food web
![GOM food web 2002](EDAB_images/LinkNEUSfoodweb.png)


---
## The Gulf of Maine food web model
![GOM food web](EDAB_images/GOMfw.png)


---
## Exercises: work in teams

.pull-left[
Anchovy Bay:

1. Describe impacts of different fishing scenarios

1. Describe potential catch and biomass objectives

1. Can you engineer any scenarios to achieve them?

]

.pull-right[
Gulf of Maine:

1. Describe impacts of different fishing scenarios

1. Describe impacts of individual species mortality scenarios

1. Describe impacts of "as prey" scenario

1. Can you suggest mechanisms for any observed differences?

1. What else do you need to know? Describe as a model scenario
(if we have enough time, I may be able to implement)

]


---
## The next level: uncertainty

What level of uncertainty is appropriate to carry through these analyses?
.pull-left[
1. Biological:

    1. appropriate sigma-R?

1. Survey specification:

    1. timing and spatial coverage?

    1. which species are captured?

    1. species-specific survey efficiency ("q")?

    1. selectivity at age for each species?

] 
.pull-right[
1. Survey uncertainty:

    1. additional observation error (survey cv for index)?
    
    1. effective sample size for biological samples?
    
1. Fishery uncertainty:
    
    1. additional observation error (catch cv for total)?
    
    1. catch sampled for length/age in all areas?
    
    1. effective sample size for biological samples?
]

---
## External Resources

* [Atlantis Model Documentation](https://github.com/Atlantis-Ecosystem-Model/Atlantis_example_and_instructions)

* [atlantisom R package](https://github.com/r4atlantis/atlantisom)

* [Testing atlantisom](https://github.com/sgaichas/poseidon-dev)

* Slides available at https://noaa-edab.github.io/presentations

---

background-image: url("EDAB_images/IMG_2733.jpg")
background-size: cover

## Questions?


# Tusen Takk til Havforskningsinstituttet!